# ZK Locationchecker with ZoKrates

Follow these steps in https://zokrates.github.io/gettingstarted.html

```
git clone https://github.com/ZoKrates/ZoKrates
cd ZoKrates
export ZOKRATES_STDLIB=$PWD/zokrates_stdlib/stdlib
cargo build -p zokrates_cli --release
cd target/release
```

To be able to run zokrates, I had to add the following paths into the startup script:

open file with `nano ~/.bashrc`

Then add 

```
export ZOKRATES_STDLIB=/mnt/c/Users/chine/EncodeBootcamp/ZKBootcamp/Zokrates/zokrates/zokrates_stdlib/stdlib
export PATH=$PATH:/mnt/c/Users/chine/EncodeBootcamp/ZKBootcamp/Zokrates/zokrates/target/release
```

then run 

`source ~/.bashrc`

Create the folder `Locationchecker`

Place `locationchecker.zok` inside with the following code:

```
def main(private field latitude, private field longitude) {
	assert(latitude <= 55 && latitude >= 50 && longitude <= 5);
	return;
}
```

run these steps:

```
# compile
zokrates compile -i locationchecker.zok
# perform the setup phase
zokrates setup
# execute the program
zokrates compute-witness -a 53 3
# generate a proof of computation
zokrates generate-proof
# export a solidity verifier
zokrates export-verifier
```

In this case, the secret is the pair `53 3` (i.e., `latitude = 53, longitude = 3`), a verifier contract `verifier.sol` is generated, and the proof is generated in the `proof.json` file (which is renamed to `proof_53_3.json`)

Generate another proof with the secret `51 1`, based on the same proving and verifier key, so it works with the same verifier contract. To replicate this step with the same proving key, copy the folder `locationchecker` which contains proving and verifier key, skip command `zokrates setup` which normally would create the proving and verifier key. Run

```
zokrates compute-witness -a 51 1
zokrates generate-proof
```

This generates another proof `proof.json` which renamed to `proof_51_1.json`.

Next step is to verify the proofs onchain.

Deploy `verifier.sol` on Ethereum Sepolia: `0xFF1b1A2de56453cA5132d786A1c6cD3B0DFE271d`

Also deploy the contracts in the `Solidity` folder: `Prooftest_location1.sol` and `Prooftest_location2.sol` with the verifier contract address `0xFF1b1A2de56453cA5132d786A1c6cD3B0DFE271d` as constructor. The numbers `a`, `b` and `c` are exactly the outputs from the `proof_53_3.json` and `proof_51_1.json` files.

`Prooftest_location1.sol` deployed on Ethereum Sepolia: `0xb157DB0aE0299720bda923C21B9b7D3851A4C864`

`Prooftest_location2.sol` deployed on Ethereum Sepolia: `0xCC7f9b5BdF0C6976A924a404b1503de96fE4bfA2`

Calling the `verifyProof` function in `Prooftest_location1.sol` and `Prooftest_location2.sol` would call the `verifyTx` function of `verifier.sol` which returns `True`.

## Simple Application

A `locationchecker_contract.sol` contract is deployed on Ethereum Sepolia `0xf791Bdf77D23A0495a4cB12aaA6C3D249a1f5995` (see `Solidity` folder or the verified contract on Etherscan)

In Remix, enter `"Hello World", [[0x1626db6c8466ddab9de279dbd04ba1fd71f1bff9759da07e3e1498e46a127c0b, 0x036b602303b384cff427af386a0af3b4a2907e99fd64f57dd6e992a02c22139e], [[0x1fe260e0c981626027aa4c6e6e3a46d189d71b68aaaa91ae1b9cd0b510320eb7, 0x074cf65cd17cefa57b376f12f2682e683348bf3f983574008e3d1afc3b679b15], [0x15532d1fab7312e7113791aa4faccab3fac049f9b2f309b294f040c0aaf7bcca, 0x27b375bfe62f936ba07a854fbaf70ed5dfe7ed0ddba5a82ffa901ec6a814fa70]], [0x1368f32b8379be72b340a99c586ce99d17ca731ca10f805c51c8d51389dae586, 0x0d9d0e9af270862f3561725197c113bf2fffdbed067ce99948ed940ac40ce26a]]` into the writeString function, and this only works if the proof (generated by Zokrates) is correct


![image](https://github.com/BigBangInfinity/Encode_ZKBootcamp_Homework/assets/37957341/3f2ce7fd-eb02-40e6-80b8-b7c1389c1edc)

